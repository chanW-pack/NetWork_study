# 네트워크 시작하기

---

## **네트워크 구성도 살펴보기**

- 홈 네트워크
- 데이터 센터 네트워크

### **홈 네트워크**

![Untitled](https://user-images.githubusercontent.com/84123877/161237055-bf357071-a593-41ba-9862-1a83c736df0b.png)

> 홈 네트워크 구성도
> 

홈 네트워크 구성은 어떤 인터넷 회선(FTTH,케이블 인터넷, VDSL)을 연결하더라도 같다.

최근 대부분의 가정에서는 공유기를 사용하고, 홈 네트워크를 구성하기 위해서는 모뎀, 공유기, 단말 간에  물리적 연결이 필요하다.

무선 연결은 무선 랜 카드와 무선 신호를 보낼 수 있는 매체(공기) 가 필요하고,    유선 연결은 유선 랜 카드(이더넷 랜 카드:일반적으로 보드에 내장), 랜 케이블(일반적으로 랜선이라 부름)이 필요하다.

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%201.png)

### 데이터 센터 네트워크

데이터 센터 네트워크는 안정적이고 빠른 대용량 서비스 제공을 목표로 구성한다. 안정적인 서비스 제공을 위해 다양한 이중화 기술을 사용해야 하고, 많은 서버와 서비스가 한 네트워크에 연결되어 있으므로 높은 통신량을 수용할 수 있어야 한다.

이런 조건을 만족하기 위해 10G, 25G, 40G, 100G, 400G와 같은 고속 이더넷 기술이 사용된다.

데이터 센터 구성은 기존에는 3계층 구성이 일반적이었지만 기상화 기술과 높은 대역폭(통신에서 이용 가능한 최대 전송 속도 /bps)을 요구하는 스케일 아웃(Scale-Out) 기반의 애플리케이션과 서비스의 등장으로 2계층 구성인 스파인-리프(Spine-Leaf) 구조로 데이터 센터 네트워크가 변화했다.

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%202.png)

> 과거 데이터 센터 네트워크 구성(왼쪽)과 현재 데이터 센터 네트워크 구성(오른쪽)의 변화
> 

---

## 프로토콜

프로토콜은 컴퓨터 내부에서, 또는 컴퓨터 사이에서 데이터의 교환 방식을 정의하는 규칙 체계이다. 기기간 통신은 교환 되는 데이터의 형식에 대해 상호 합의를 요구하는데 이런 형식을 정의하는 규칙의 집합을 프로토콜이라고 한다.

- 물리적 측면: 데이터 전송 매체, 신호 규약, 회선 규격 등. 이더넷이 널리 쓰임
- 논리적 측면: 장치들끼리 통신하기 위한 프로토콜 규격. TCP/IP가 널리 쓰임

TCP/IP는 프로토콜이라고 부르지 않고 프로토콜 스택이라고 부른다. TCP와 IP는 별도 계층에서 동작하지만 함께 사용하고 있는데 이런 프로토콜 묶음을 프로토콜 스택이라고 부른다.

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%203.png)

> TCP/IP 프로토콜 스택
> 

---

## OSI 7계층과 TCP/IP

- OSI 7계층
- TCP/IP 프로토콜 스택

### OSI 7계층

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%204.png)

> OSI 레퍼런스 모델
> 

OSI 7계층은 두 가지 계층으로 나눌 수 있다.

- 1~4계층: 데이터 플로 계층(Data Flow Layer) / 하위 계층(Lower Layer)
- 5~7계층: 애플리케이션 계층(Application Layer) / 상위 계층(Upper Layer)

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%205.png)

> OSI 7계층은 데이터 플로 계층과 애플리케이션 계층으로 구분한다.
> 

### TCP/IP 프로토콜 스택

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%206.png)

> OSI 레퍼런스 모델은 7계층으로 이루어진 반면, TCP/IP 모델은 4계층으로 이루어져 있다.
> 

TCP/IP와 OSI 모델의 주요 차이점

- TCP/IP는 클라이언트 - 서버 모델이다. 즉 클라이언트가 서비스를 요청하면 서버가 제공되는 반면 OSI는 개념 모델이다.
- TCP/IP는 인터넷을 포함한 모든 네트워크에 사용되는 표준 프로토콜이지만 OSI는 프로토콜이 아닌 시스템 이키텍처를 이해하고 셀계하는데 사용되는 참고 모델이다.
- TCP/IP는 수직 접근 방식을 따른다. 한편 OSI모델은 수평적 접근을 지원한다.

---

## OSI 7계층별 이해

- 1계층(피지컬 계층)
    - 1계층은 물리 계층으로 물리적 연결과 관련된 정보를 정의합니다.
    
- 2계층(데이터 링크 계층)
    - 2계층은 데이터 링크 계층으로 전기 신호를 모아 우리가 알아볼 수 있는 데이터 형태로 처리합니다.
    
- 3계층(네트워크 계층)
    - 3계층에서는 IP주소와 같은 논리적인 주소가 정의됩니다.
    
- 4계층(트랜스포트 계층)
    - 하위 계층(1,2,3계층)은 신호와 데이터를 올바른 위치로 보내고 만드는데 집중하게 하고 4계층이 실제로 해당 데이터들이 정상적으로 잘 보내지도록 확인하는 역할을 한다.
    
- 5계층(세션 계층)
    - 5계층은 세션 계층은 양 끝단의 응용 프로세스가 연결을 성립하도록 도와주고 연결이 안정적으로 유지되도록 관리하고 작업 완료 이후에는 연결을 끊는 역할을 한다.
    
- 6계층(프레젠테이션 계층)
    - 6계층인 프레젠테이션 계층은 표현 방식이 다른 애플리케이션이나 시스템 간의 통신을 돕기 위해 하나의 통일된 구문 형식으로 변환시키는 역할을 수행한다.
    
- 7계층(애플리케이션 계층)
    - 최상위 7계층인 애플리케이션 계층은 애플리케이션 프로세스를 정의하고 애플리케이션 서비스를 수행한다.
    
    ![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%207.png)
    
    - 데이터를 각 계층에 전송할 때 마다 층마다 인식을 할 수 있도록 헤더를 붙이는 과정을 캡술화 과정(인캡슐레이션) 이라고 한다
    - 전송 매체를 통해 전송 된 데이터가 1계층부터 7계층까지 올라오면서 해더를 벗는 과정을 디캡슐레이션 이라고 한다.
    - 자세한 설명은 인캡슐레이션과 디캡슐레이션 파트에서 진행하겠다.
    
    ---
    

## 인캡슐레이션과 디캡슐레이션

상위 계층에서 하위 계층으로 데이터를 보내면 물리 계층에서 전기 신호 형태로 네트워크를 통해 신호를 보낸다. 받는 쪽에서는 다시 하위 계층에서 상위 계층으로 데이터를 보낸다.

이렇게 데이터를 보내는 과정을 인캡슐레이션(Enacpsulation), 받는 과정을 디캡슐레이션(Decapsulation)이라고 부른다

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%208.png)

> 인캡슐레이션과 디캡슐레이션
> 

현대 네트워크는 패킷 기반으로 데이터를 작은 단위로 쪼개 보낸다. 이런 기법으로 하나의 통신이 회선 전체를 점유하지 않고 동시에 여러 단말이 통신하도록 해준다.

데이터를 패킷으로 쪼개고 네트워크를 이용해 목적지로 보내고 받는 쪽에서는 패킷을 다시 큰 데이터 형태로 결합해 사용한다.

### 인캡슐레이션

애플리케이션에서 데이터를 데이터 플로 계층으로 내려보내면서 패킷에 데이터를 넣을 수 있도록 분할하는 과정

- 네트워크 상황을 고려해 적절한 크기로 데이터를 쪼개고, 4계층부터 네트워크 전송을 위한 정보를 헤더에 붙여넣는다.
- 4,3,2계층에서 각각 필요한 헤더를 추가해 데이터 플로 계층에서만 3개의 헤더 정보가 추가된다.

### 디캡슐레이션

받는 쪽에서 디캡슐레이션 과정을 수행

1.  받은 전기 신호를 데이터 형태로 만들어 2계층으로 올려보낸다
2. 2계층에서는 송신자가 작성한 2계층 헤더에 포함된 정보를 확인
    - 만약 정보 중 목적지가 자신이 아니라면 자신에게 온 패킷이 아니므로 버린다.
    - 이 부분은 랜 카드가 담당
    
3. 목적지가 자신이 맞다면 3계층으로 이 정보를 보냄. 이때 2계층의 헤더 정보는 더 이상 필요없으므로 벗겨내고 올려보내 줌
4. 이 데이터를 받은 3계층에서는 2계층이 동작했던 것처럼 상대방이 적은 3계층의 헤더 정보를 확인해 자신에게 온 것이 맞는지 확인하고, 맞다면 헤더를 벗겨내 4계층으로 보냄

이를 받은 4계층도 3계층과 같은 과정을 거쳐 어플리케이션에 데이터를 올려보내줌. 이 데이터 전달 과정을 두 가지 정보 흐름으로 정리하자면

- 인캡술레이션, 디캡슐레이션 과정을 통해 데이터가 전송되는 과정
- 각 계층 헤더를 이용해 송신자 계층과 수신자 계층 간의 논리적 통신 과정

실제 데이터는 상위 계층 > 하위 계층, 하위 계층 > 상위 계층으로 전달되고 헤더 정보는 각 계층끼리 전달된다.

인캡슐레이션 과정에서는 상위 프로토콜이 많아도 문제가 없지만 디캡슐에이션하는 목적지 쪽에서는 헤더에 아무 정보가 없으면 어떤 상위 프로토콜로 올려보내 주어야 할지 결정할 수 없다.

이런 문제가 발생하지 않도록 인캡슐레이션하는 쪽에서는 헤더에 상위 프로토콜 지시자 정보를 포함해야 한다.

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%209.png)

> 잘 알려진 상위 프로토콜 지시자: 프로토콜 번호
> 

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2010.png)

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2011.png)

> ... : 포트 번호
> 

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2012.png)

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2013.png)

> ... : 이더 타입
> 

---

## 와이어샤크(Wireshark)를 사용하여 OSI 7계층 분석

Wireshark는 무료 오픈 소스 네트워크 패킷 분석 프로그램이다. 개별 패킷 내의 프로토콜 정보를 세부적으로 파악할 수 있으며 직관적인 GUI를 제공해 네트워크상의 트러블 슈팅과 각종 보안 이슈 진단에 쓰여왔고, Ethernet 인터페이스에만 국한되지 않고, IEEE 802.11(무선랜), Bluetooth 등과 같은 네트워크 환경에서 자주 활용되기도 한다

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2014.png)

> [https://www.wireshark.org/download.html](https://www.wireshark.org/download.html) 주소에서설치 진행
> 

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2015.png)

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2016.png)

> VMware ubuntu server를 가동시키고 패킷 데이터 수집
> 

### **1. DataLink Layer**

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2017.png)

- 빨간 네모 안에 패킷들은 MAC에 관련된 정보들이다.
- 이 부분은 MAC(물리 주소) Protocol 정보가 들어있다.

### 2. **Network Layer (Intenet Protocol)**

![Untitled](%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%89%2009dac/Untitled%2018.png)

- Internet Protocol은 데이터그램이 속한 프로토콜 버전(version), 데이터그램 내의 헤더와 데이터의 길이를 합한 값, 프로토콜, 출발지주소, 도착지주소 등으로 구성

이후에도 Transprot Layer, Application Layer 등의 패킷을 확인 가능하다.

---
