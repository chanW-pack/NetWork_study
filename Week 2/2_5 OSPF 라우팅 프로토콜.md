# OSPF 라우팅 프로토콜

- OSFP (Open Shortest First)
- 컨버전스타임(Convergence time)이란 라우터 간에 서로 변경된 정보를 주고받는데 걸리는 시간
    - RIP의 경우는 30초 + a 로 오래걸리지만 OSPF는 변화가 생기면 바로 전달이 가능해            **속도가 빠르다.**
    - 따라서 **큰 네트워크에 적합**한 프로토콜이다.
    - 특히 Area(에어리어)라는 개념을 적용해 전체 OSPF 네트워크를 작은 영역으로 나누어 관리해 효율적이다.
    
- **VLSM을 확실하게 지원한다.**
    - IP주소를 효과적으로 사용할 수 있고 라우팅 테이블을 줄이는 부수적인 효과도 있다.
    - 이를 위해 서머리제이션(Route smmarization)을 지원해 여러 라우팅 경로를 하나로 묶어주는 기능이 탁월하다.
    
- 네트워크 크기의 제한이 있어 RIP은 15개까지인데 **OSPF는 제한이 없다.**
- RIP은 30초마다 브로드캐스트가 발생해 대역폭 낭비가 심하지만 **OSPF는 네트워크에 변화가 있을 때만 정보가 날아가고** 그것도 멀티캐스트 이기 때문에 실용적이다.
- RIP은 홉카운트만을 따지기 때문에 속도나 딜레이와 상관없이 무조건 홉 카운트 적은것만 선호하지만 **OSPF는 많은 요소를 합쳐서 경로를 선택해** **훨씬 정확한 경로선택**이 가능하다.
- 표준 라우팅 프로토콜이며, 링크스테이트 라우팅 알고리즘이다.

*링크스테이트 = 한 라우터에서 목적지까지의 모든 경로를 알고있는 알고리즘

- OSPF는 토폴로지가 바뀌는 것에 따라 약간씩 동작이 바뀐다.
    1. 브로드캐스트 멀티액세스 토폴로지
        - 네트워크에 두 개 이상의 라우터가 연결되는 경우
        - 하나의 메세지를 보내면 이 네트워크 상의 모든 라우터들이 정보를 받아볼 수 있다.
        - 이더넷 세그먼트(연결해주는 선 정도로 이해)가 여기에 속해있다.
        
    2. 포인트 투 포인트 토폴로지
        - 네트워크에 한 쌍의 라우터만 존재하는 경우
        - 전용선이 여기에 속한다.
        
    3. NBMA토폴로지(Non Broadcast Multi-access)
        - 네트워크에 두 개 이상의 라우터가 연결되는 경우
        - 브로드캐스트 멀티액세스와  다르게 브로드캐스트 능력을 가지고 있지 않는다.
        - 프레임릴레이나 X.25 네트워크가 여기에 해당한다.
# OSPF Neighbor(이웃) 개념과 찾는 방법

## Neighbor 란?

**주위에 있는 OSPF 라우터들**을 의미하며, *Hello 패킷을 멀티캐스팅해서 이웃을 찾은 후, 라우터들은 자신의 DB에 이웃을 저장한다.

즉, 주위에 있는 OSPF 라우터를 찾아 자신의 DB에 저장하여 주위 OSPF 라우터와 이웃관계가 되고,

**이웃 관계가 되어야 통신이 가능하다.**

*hello 패킷 : 통상, 두 라우터 간에 인접관계를 설정하고 유지하는 기능을 수행 

(근처 노드 간의 이웃(Neighbor)관계의 성립 및 유지)

### neighbor를 찾는 과정

1. Down State
    - 다운되어 있던 라우터가 켜지는 상태
    
2. init State
    - 헬로 메세지를 멀티캐스팅한다.
    - 헬로를 받은 라우터들은 자신들의 이웃 목록에 해당 라우터 추가
    
    *  **멀티캐스트를 이용**하므로, 네트워크 내에서 **OSPF로 동작하는 라우터만** 메세지를 수신한다.
    

1. Two-way state
    - 헬로 메세지를 받은 라우터들이 **유니캐스트를 이용**해서, **자신의 정보 전달**
    

### Hello Packet 구성

- Router ID
- Hello/dead intervals (중요)
- Neighbors
- Area-ID (중요)
- DR IP address
- BDR IP address
- Authenitcation password (중요)

1. OSPF로 통신하는 라우터들간에 다음 항목의 값이 모두 같아야만 이웃이 맺어질 수 있다.
    - Hello/dead intervals
    - Area-ID
    - Authenication password
    - Stub area flag
    
2. hello 패킷은 10초에 한번씩 발생한다.

1. **라우터 ID (RID)는 라우터의 IP중 가장 높은 주소를 사용**한다. 인터페이스들이 죽었다 살아나는것을 반복한다면 RID가 자꾸 바뀔 가능성이 있다.

1. RID가 변경될 때마다 라우터 정보도 끊임없이 바뀌어야 하므로, 보통 *루프백(loopback)인터페이스 주소를 RID로 지정해서 사용한다.

*루프백 인터페이스 :루프백 인터페이스는 시스코 라우터에 존재하는 특별한 가상의 인터페이스다.

## 주의 :

<aside>
⛔ 만약, 이미 RID가 있는 상태에서 loopback interface를 만들면 바로 RID가 적용되지 않고, 라우터를 재부팅 또는 OSPF 프로토콜을 내렸다가 다시 올려야한다.

</aside>

